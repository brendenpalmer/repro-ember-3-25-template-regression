{{! Template from `ilios` with MIT license }}
{{! Repo URL: https://github.com/ilios/frontend }}
{{#let (unique-id) as |templateId|}}
  <div class="learnergroup-cohort-user-manager" data-test-learnergroup-cohort-user-manager ...attributes>
    <div class="learnergroup-cohort-user-manager-header">
      <div class="title" data-test-title>
        {{t "general.cohortMembersNotInGroup" groupTitle=@topLevelGroupTitle}}
        ({{@users.length}})
      </div>
      <div class="actions">
        <Input
          @value={{this.filter}}
          placeholder={{t "general.filterByNameOrEmail"}}
          aria-label={{t "general.filterByNameOrEmail"}}
          data-test-filter
        />
      </div>
    </div>
    <div class="learnergroup-cohort-user-manager-content" >
      <div class="list">
        <table>
          <thead data-test-headers>
            <tr>
              <th class="text-left" colspan="1">
                <Input
                  @type="checkbox"
                  @checked={{and
                    (includes this.selectableUsers this.selectedUsers)
                    this.selectedUsers.length
                  }}
                  indeterminate={{and
                    (not (includes this.selectableUsers this.selectedUsers))
                    this.selectedUsers.length
                  }}
                  aria-label={{t "general.selectAllOrNone"}}
                  {{on "click" this.toggleUserSelectionAllOrNone}}
                />
              </th>
              <SortableTh
                @colspan={{4}}
                @onClick={{fn this.setSortBy "fullName"}}
                @sortedBy={{or (eq @sortBy "fullName") (eq @sortBy "fullName:desc")}}
                @sortedAscending={{this.sortedAscending}}
              >
                {{t "general.name"}}
              </SortableTh>
              <th class="text-left" colspan="2">
                {{t "general.campusId"}}
              </th>
              <th class="text-left hide-from-small-screen" colspan="5">
                {{t "general.email"}}
              </th>
              <th class="text-left" colspan="1">
                {{t "general.actions"}}
              </th>
            </tr>
          </thead>
          <tbody data-test-users>
            {{#each (sort-by @sortBy this.filteredUsers) as |user index|}}
              <tr class={{unless user.enabled "disabled-user-account"}}>
                <td class="text-left" colspan="1">
                  {{#if (or user.enabled this.currentUser.isRoot)}}
                    {{#if @canUpdate}}
                      <input
                        type="checkbox"
                        checked={{includes user selectedUsers}}
                        aria-labelledby="username-{{index}}-{{templateId}}"
                        {{on "click" (fn this.toggleUserSelection user)}}
                      >
                    {{/if}}
                  {{/if}}
                  {{#unless user.enabled}}
                    <FaIcon
                      @icon="user-times"
                      @title={{t "general.disabled"}}
                      class="error"
                      data-test-is-disabled
                    />
                  {{/unless}}
                </td>
                <td class="text-left" colspan="4">
                  <UserNameInfo id="username-{{index}}-{{templateId}}" @user={{user}} />
                </td>
                <td class="text-left" colspan="2">
                  {{user.campusId}}
                </td>
                <td class="text-left hide-from-small-screen" colspan="5">
                  {{user.email}}
                </td>
                <td class="text-left" colspan="1">
                  {{#if user.enabled}}
                    {{#if (includes user this.usersBeingMoved)}}
                      <LoadingSpinner />
                    {{else if (and @canUpdate (eq this.selectedUsers.length 0))}}
                      <FaIcon
                        @icon="plus"
                        class="yes clickable"
                        @title={{t
                          "general.moveToGroup"
                          groupTitle=@learnerGroupTitle
                          count=1
                        }}
                        @click={{perform this.addSingleUser user}}
                      />
                    {{/if}}
                  {{/if}}
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      </div>
    </div>
    {{#if (gt this.selectedUsers.length 0)}}
      <button type="button" class="done text" {{on "click" (perform this.addSelectedUsers)}}>
        {{t
          "general.moveToGroup"
          groupTitle=@learnerGroupTitle
          count=this.selectedUsers.length
        }}
      </button>
    {{/if}}
  </div>
{{/let}}
